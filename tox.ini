[tox]
min_version = 4
env_list =
    format
    lint
    py310-test
requires =
    tox-ignore-env-name-mismatch

[testenv:.pkg]
pass_env = SETUPTOOLS_SCM_PRETEND_VERSION

[testenv]
package = wheel
wheel_build_env = .pkg
runner = ignore_env_name_mismatch
extras = dev

[testenv:format]
base_python = py310
envdir = {toxworkdir}/format-lint
commands =
    isort eurocropsmeta tests
    black eurocropsmeta tests
    ruff check --fix eurocropsmeta tests

[testenv:lint]
base_python = py310
envdir = {toxworkdir}/format-lint
commands =
    mypy eurocropsmeta tests
    ruff check eurocropsmeta tests {posargs}

[testenv:py310-test]
base_python = py310
deps =
    # pinning NumPy to <2 to prevent the ABI incompatibility crash 
    # with dependent libraries like PyTorch that were compiled against NumPy 1.x.
    numpy<2
    # ensure pytest is installed in this environment
    pytest
commands =
    pytest -v {posargs}